<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>樱花表白墙</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF7B9C',
            secondary: '#FFB6C1',
            accent: '#FFD1DC',
            light: '#FFF0F5',
            dark: '#8B4513'
          },
          fontFamily: {
            romantic: ['Dancing Script', 'cursive', 'sans-serif'],
            main: ['Inter', 'system-ui', 'sans-serif']
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }
      .card-shadow {
        box-shadow: 0 10px 15px -3px rgba(255, 123, 156, 0.1), 0 4px 6px -2px rgba(255, 123, 156, 0.05);
      }
      .cherry-blossom {
        position: absolute;
        background-color: #FFB6C1;
        border-radius: 50% 50% 50% 0;
        opacity: 0.8;
        animation: fall linear infinite;
      }
    }
  </style>
  
  <!-- 引入Google字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* 樱花飘落动画 */
    @keyframes fall {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 0.8;
      }
      100% {
        transform: translate(var(--x-end), 100vh) rotate(360deg);
        opacity: 0;
      }
    }
    
    /* 平滑滚动 */
    html {
      scroll-behavior: smooth;
    }
    
    /* 背景渐变 */
    body {
      background: linear-gradient(135deg, #FFF0F5 0%, #FFE4E1 100%);
      background-attachment: fixed;
    }
  </style>
</head>

<body class="font-main text-gray-800 min-h-screen relative overflow-x-hidden">
  <!-- 樱花容器 - 会通过JS动态生成樱花 -->
  <div id="cherry-blossoms-container" class="fixed top-0 left-0 w-full h-full pointer-events-none z-10"></div>

  <!-- 页面标题 -->
  <header class="py-12 px-4 text-center relative z-20">
    <h1 class="font-romantic text-[clamp(2.5rem,6vw,4rem)] font-bold text-primary text-shadow">
      樱花表白墙
    </h1>
    <p class="mt-2 text-gray-600 max-w-lg mx-auto">
      在这里，留下你最真挚的情感，让樱花带走你的心意
    </p>
  </header>

  <!-- 主要内容区 -->
  <main class="max-w-6xl mx-auto px-4 pb-20 relative z-20">
    <!-- 表白表单 -->
    <section class="mb-16 bg-white rounded-2xl p-6 md:p-8 card-shadow transform transition-all duration-300 hover:scale-[1.01]">
      <h2 class="font-romantic text-[clamp(1.8rem,4vw,2.5rem)] text-primary mb-6 text-center">写下你的心意</h2>
      
      <form id="confession-form" class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="sender" class="block text-sm font-medium text-gray-700 mb-1">你的名字</label>
            <input 
              type="text" 
              id="sender" 
              class="w-full px-4 py-2 border border-secondary rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all outline-none"
              placeholder="不愿透露可以留空"
            >
          </div>
          <div>
            <label for="recipient" class="block text-sm font-medium text-gray-700 mb-1">TA的名字</label>
            <input 
              type="text" 
              id="recipient" 
              class="w-full px-4 py-2 border border-secondary rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all outline-none"
              required
              placeholder="例如：亲爱的小明"
            >
          </div>
        </div>
        
        <div>
          <label for="message" class="block text-sm font-medium text-gray-700 mb-1">表白内容</label>
          <textarea 
            id="message" 
            rows="4" 
            class="w-full px-4 py-2 border border-secondary rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all outline-none resize-none"
            required
            placeholder="把你想说的话写在这里..."
          ></textarea>
        </div>
        
        <div class="flex justify-center">
          <button 
            type="submit" 
            class="bg-primary hover:bg-primary/90 text-white font-medium px-6 py-3 rounded-full transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 flex items-center"
          >
            <i class="fa fa-paper-plane mr-2"></i> 发送心意
          </button>
        </div>
      </form>
    </section>
    
    <!-- 表白墙内容 -->
    <section>
      <h2 class="font-romantic text-[clamp(1.8rem,4vw,2.5rem)] text-primary mb-8 text-center">大家的心意</h2>
      
      <div id="confessions-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- 这里将通过JavaScript动态填充表白内容 -->
        <!-- 示例表白卡片 -->
        <div class="bg-white rounded-xl p-6 card-shadow transition-all duration-300 hover:translate-y-[-5px] hover:shadow-lg">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="font-semibold text-lg text-primary">致 小红</h3>
              <p class="text-sm text-gray-500">来自：小明</p>
            </div>
            <span class="text-xs bg-accent text-primary px-2 py-1 rounded-full">今天</span>
          </div>
          <p class="text-gray-700 mb-4">第一次见到你，我的心跳就漏了一拍。你的笑容像春日里最暖的阳光，希望能有机会和你一起看樱花。</p>
          <div class="flex justify-end items-center text-sm text-gray-400">
            <button class="like-btn flex items-center hover:text-primary transition-colors">
              <i class="fa fa-heart-o mr-1"></i> <span>12</span>
            </button>
          </div>
        </div>
      </div>
      
      <!-- 空状态提示 -->
      <div id="empty-state" class="text-center py-16 hidden">
        <i class="fa fa-heart text-6xl text-secondary/50 mb-4"></i>
        <p class="text-gray-500">还没有人留下心意呢，做第一个勇敢表达的人吧！</p>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white/80 backdrop-blur-sm py-6 px-4 text-center text-gray-500 text-sm relative z-20">
    <p>樱花表白墙 &copy; 2023 | 让每一份心意都被看见</p>
  </footer>

  <!-- 成功提示弹窗 -->
  <div id="success-toast" class="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-primary text-white px-6 py-3 rounded-full shadow-lg flex items-center opacity-0 transition-opacity duration-300 z-50">
    <i class="fa fa-check-circle mr-2"></i>
    <span>表白发布成功！</span>
  </div>

  <script>
    // 樱花特效实现
    function createCherryBlossoms() {
      const container = document.getElementById('cherry-blossoms-container');
      const numberOfBlossoms = window.innerWidth < 768 ? 30 : 60; // 根据屏幕大小调整樱花数量
      
      // 清除现有樱花
      container.innerHTML = '';
      
      for (let i = 0; i < numberOfBlossoms; i++) {
        const blossom = document.createElement('div');
        blossom.classList.add('cherry-blossom');
        
        // 随机大小
        const size = Math.random() * 8 + 3;
        blossom.style.width = `${size}px`;
        blossom.style.height = `${size}px`;
        
        // 随机初始位置
        blossom.style.left = `${Math.random() * 100}vw`;
        blossom.style.top = `-${size}px`;
        
        // 随机飘落距离和时间
        const duration = Math.random() * 15 + 10;
        const xEnd = Math.random() * 100 - 50; // 左右飘动范围
        
        blossom.style.setProperty('--x-end', `${xEnd}px`);
        blossom.style.animationDuration = `${duration}s`;
        blossom.style.animationDelay = `${Math.random() * 10}s`;
        
        // 随机旋转角度
        blossom.style.transform = `rotate(${Math.random() * 360}deg)`;
        
        // 随机透明度和颜色深浅
        const opacity = Math.random() * 0.5 + 0.3;
        const hue = Math.random() * 20 + 340; // 粉色范围
        const lightness = Math.random() * 10 + 85;
        blossom.style.opacity = opacity;
        blossom.style.backgroundColor = `hsl(${hue}, 100%, ${lightness}%)`;
        
        container.appendChild(blossom);
      }
    }
    
    // 初始化樱花
    createCherryBlossoms();
    // 窗口大小改变时重新生成樱花
    window.addEventListener('resize', createCherryBlossoms);
    
    // 表白墙功能
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('confession-form');
      const confessionsContainer = document.getElementById('confessions-container');
      const emptyState = document.getElementById('empty-state');
      const successToast = document.getElementById('success-toast');
      
      // 从本地存储加载表白内容
      loadConfessions();
      
      // 表单提交处理
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const sender = document.getElementById('sender').value.trim() || '匿名';
        const recipient = document.getElementById('recipient').value.trim();
        const message = document.getElementById('message').value.trim();
        
        // 创建表白对象
        const confession = {
          id: Date.now(),
          sender,
          recipient,
          message,
          timestamp: new Date(),
          likes: 0
        };
        
        // 保存表白
        saveConfession(confession);
        
        // 添加到页面
        addConfessionToDOM(confession);
        
        // 重置表单
        form.reset();
        
        // 显示成功提示
        showSuccessToast();
      });
      
      // 显示成功提示
      function showSuccessToast() {
        successToast.style.opacity = '1';
        setTimeout(() => {
          successToast.style.opacity = '0';
        }, 3000);
      }
      
      // 保存表白到本地存储
      function saveConfession(confession) {
        let confessions = JSON.parse(localStorage.getItem('confessions') || '[]');
        confessions.unshift(confession); // 添加到开头
        localStorage.setItem('confessions', JSON.stringify(confessions));
      }
      
      // 从本地存储加载表白
      function loadConfessions() {
        let confessions = JSON.parse(localStorage.getItem('confessions') || '[]');
        
        // 清空现有内容（除了示例）
        if (confessions.length === 0) {
          // 只保留示例卡片
          const exampleCard = confessionsContainer.querySelector('div');
          confessionsContainer.innerHTML = '';
          if (exampleCard) confessionsContainer.appendChild(exampleCard);
          return;
        }
        
        // 清空容器
        confessionsContainer.innerHTML = '';
        
        // 添加所有表白
        confessions.forEach(confession => {
          addConfessionToDOM(confession);
        });
      }
      
      // 添加表白到DOM
      function addConfessionToDOM(confession) {
        const date = new Date(confession.timestamp);
        const formattedDate = getRelativeTime(date);
        
        const card = document.createElement('div');
        card.className = 'bg-white rounded-xl p-6 card-shadow transition-all duration-300 hover:translate-y-[-5px] hover:shadow-lg';
        card.dataset.id = confession.id;
        
        card.innerHTML = `
          <div class="flex justify-between items-start mb-4">
            <div>
              <h3 class="font-semibold text-lg text-primary">致 ${confession.recipient}</h3>
              <p class="text-sm text-gray-500">来自：${confession.sender}</p>
            </div>
            <span class="text-xs bg-accent text-primary px-2 py-1 rounded-full">${formattedDate}</span>
          </div>
          <p class="text-gray-700 mb-4">${confession.message}</p>
          <div class="flex justify-end items-center text-sm text-gray-400">
            <button class="like-btn flex items-center hover:text-primary transition-colors">
              <i class="fa fa-heart-o mr-1"></i> <span>${confession.likes}</span>
            </button>
          </div>
        `;
        
        // 添加点赞功能
        const likeBtn = card.querySelector('.like-btn');
        likeBtn.addEventListener('click', function() {
          const likeCountEl = likeBtn.querySelector('span');
          let likeCount = parseInt(likeCountEl.textContent);
          likeCount++;
          likeCountEl.textContent = likeCount;
          
          // 更新本地存储中的点赞数
          updateConfessionLikes(confession.id, likeCount);
          
          // 改变图标
          const icon = likeBtn.querySelector('i');
          icon.classList.remove('fa-heart-o');
          icon.classList.add('fa-heart');
          likeBtn.classList.add('text-primary');
          likeBtn.removeEventListener('click', arguments.callee);
        });
        
        confessionsContainer.prepend(card);
        checkEmptyState();
      }
      
      // 更新表白的点赞数
      function updateConfessionLikes(id, likes) {
        let confessions = JSON.parse(localStorage.getItem('confessions') || '[]');
        const index = confessions.findIndex(c => c.id === id);
        if (index !== -1) {
          confessions[index].likes = likes;
          localStorage.setItem('confessions', JSON.stringify(confessions));
        }
      }
      
      // 检查是否为空状态
      function checkEmptyState() {
        const confessions = JSON.parse(localStorage.getItem('confessions') || '[]');
        if (confessions.length === 0 && confessionsContainer.children.length === 0) {
          emptyState.classList.remove('hidden');
        } else {
          emptyState.classList.add('hidden');
        }
      }
      
      // 获取相对时间（如：刚刚、5分钟前、昨天等）
      function getRelativeTime(date) {
        const now = new Date();
        const diffInSeconds = Math.floor((now - date) / 1000);
        
        if (diffInSeconds < 60) {
          return '刚刚';
        } else if (diffInSeconds < 3600) {
          const minutes = Math.floor(diffInSeconds / 60);
          return `${minutes}分钟前`;
        } else if (diffInSeconds < 86400) {
          const hours = Math.floor(diffInSeconds / 3600);
          return `${hours}小时前`;
        } else if (diffInSeconds < 604800) {
          const days = Math.floor(diffInSeconds / 86400);
          return `${days}天前`;
        } else {
          return `${date.getMonth() + 1}月${date.getDate()}日`;
        }
      }
    });
  </script>
</body>
</html>
